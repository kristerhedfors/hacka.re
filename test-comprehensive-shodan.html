<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Comprehensive Shodan Integration</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .function-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }
        .function-item {
            padding: 10px;
            background: #f5f5f5;
            border-radius: 4px;
            font-family: monospace;
        }
        button {
            background: #007cba;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #005a8b;
        }
        #output {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 4px;
            white-space: pre-wrap;
            font-family: monospace;
            max-height: 400px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <h1>üîç Comprehensive Shodan Integration Test</h1>
    
    <div class="section">
        <h2>Available Shodan Functions</h2>
        <p>The comprehensive Shodan MCP integration now includes:</p>
        
        <h3>üîç Search Methods</h3>
        <div class="function-list">
            <div class="function-item">shodan_host_info(ip, history?, minify?)</div>
            <div class="function-item">shodan_search(query, facets?, page?, minify?)</div>
            <div class="function-item">shodan_search_count(query, facets?)</div>
            <div class="function-item">shodan_search_facets()</div>
            <div class="function-item">shodan_search_filters()</div>
            <div class="function-item">shodan_search_tokens(query)</div>
        </div>

        <h3>üì° Scanning Methods</h3>
        <div class="function-list">
            <div class="function-item">shodan_scan(ips, force?)</div>
            <div class="function-item">shodan_scan_protocols()</div>
        </div>

        <h3>üåê DNS Methods</h3>
        <div class="function-list">
            <div class="function-item">shodan_dns_domain(domain, history?, type?, page?)</div>
            <div class="function-item">shodan_dns_resolve(hostnames)</div>
            <div class="function-item">shodan_dns_reverse(ips)</div>
        </div>

        <h3>üë§ Account & Utility Methods</h3>
        <div class="function-list">
            <div class="function-item">shodan_account_profile()</div>
            <div class="function-item">shodan_api_info()</div>
            <div class="function-item">shodan_tools_myip()</div>
        </div>

        <h3>üõ°Ô∏è Security Analysis</h3>
        <div class="function-list">
            <div class="function-item">shodan_labs_honeyscore(ip)</div>
        </div>
    </div>

    <div class="section">
        <h2>Quick Tests</h2>
        <p>Click these buttons to test different functions (requires Shodan API key setup):</p>
        
        <button onclick="testFunction('shodan_api_info', {})">Test API Info</button>
        <button onclick="testFunction('shodan_search_filters', {})">Test Search Filters</button>
        <button onclick="testFunction('shodan_tools_myip', {})">Test My IP</button>
        <button onclick="testFunction('shodan_host_info', {ip: '8.8.8.8'})">Test Host Info (8.8.8.8)</button>
        <button onclick="testFunction('shodan_search_count', {query: 'apache'})">Test Search Count (Apache)</button>
        <button onclick="testFunction('shodan_dns_resolve', {hostnames: 'google.com'})">Test DNS Resolve</button>
        <button onclick="testFunction('shodan_labs_honeyscore', {ip: '1.1.1.1'})">Test Honeyscore</button>
        
        <h3>Output:</h3>
        <div id="output">Click a test button above to see results...</div>
    </div>

    <div class="section">
        <h2>Integration Status</h2>
        <div id="status">
            <p><strong>‚úÖ MCP Server:</strong> Comprehensive Python server implemented with 22 tools</p>
            <p><strong>‚úÖ Service Connectors:</strong> Updated with full API support and 14 main functions</p>
            <p><strong>‚úÖ Quick Connectors:</strong> Shodan card available in MCP modal</p>
            <p><strong>‚úÖ Authentication:</strong> API key-based auth with validation</p>
            <p><strong>‚úÖ Response Formatting:</strong> Intelligent formatting for different response types</p>
            <p><strong>‚úÖ Error Handling:</strong> Comprehensive error handling for all HTTP status codes</p>
        </div>
    </div>

    <script>
        async function testFunction(functionName, params) {
            const output = document.getElementById('output');
            output.textContent = `Testing ${functionName}...\n`;

            try {
                // Check if function exists in global scope
                if (typeof window[functionName] === 'function') {
                    const result = await window[functionName](...Object.values(params));
                    output.textContent = `‚úÖ ${functionName} executed successfully:\n\n${JSON.stringify(result, null, 2)}`;
                } else {
                    output.textContent = `‚ö†Ô∏è  Function ${functionName} not available yet.\n\nTo test:\n1. Open hacka.re\n2. Connect to Shodan via MCP modal\n3. Enter your Shodan API key\n4. Use functions in chat or Function Calling UI\n\nExample usage:\n${functionName}(${JSON.stringify(params, null, 2)})`;
                }
            } catch (error) {
                output.textContent = `‚ùå Error testing ${functionName}:\n${error.message}`;
            }
        }

        // Display current integration status
        function updateStatus() {
            const statusDiv = document.getElementById('status');
            const checks = [
                { name: 'MCPServiceConnectors available', check: () => !!window.MCPServiceConnectors },
                { name: 'Shodan config in SERVICE_CONFIGS', check: () => {
                    try {
                        return window.MCPServiceConnectors && 
                               window.MCPServiceConnectors.getAvailableServices &&
                               window.MCPServiceConnectors.getAvailableServices().some(s => s.key === 'shodan');
                    } catch (e) {
                        return false;
                    }
                }},
                { name: 'Function calling system', check: () => !!window.FunctionToolsRegistry },
            ];

            let statusHTML = '';
            for (const check of checks) {
                const status = check.check() ? '‚úÖ' : '‚ùå';
                statusHTML += `<p>${status} <strong>${check.name}</strong></p>`;
            }
            
            statusDiv.innerHTML = statusHTML;
        }

        // Update status when page loads
        window.addEventListener('load', () => {
            setTimeout(updateStatus, 1000); // Give time for scripts to load
        });
    </script>
</body>
</html>