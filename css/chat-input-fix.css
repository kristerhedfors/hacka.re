/* Fix for cramped chat input at all screen sizes */

/* Ensure chat input container takes full width */
#chat-input-container {
    width: 100%;
    box-sizing: border-box;
}

/* Fix the input-with-actions container to take full width */
.input-with-actions {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    width: 100%;
    box-sizing: border-box;
}

/* Ensure chat form takes available space */
#chat-form {
    display: flex;
    gap: 0.5rem;
    flex: 1;
    align-items: center;
    box-sizing: border-box;
}

/* Prevent wrapper from shrinking the input */
#chat-form .message-input-wrapper,
#chat-form #message-input-wrapper {
    flex: 1 1 auto !important;
    min-width: 0;
    width: auto !important;
}

/* Force input to maintain size inside wrapper */
#message-input-wrapper > #message-input,
.message-input-wrapper > #message-input {
    flex: 1 1 auto !important;
    width: 100%;
}

/* Ensure consistent layout whether wrapper exists or not */
#chat-form > #message-input,
#chat-form .message-input-wrapper,
#chat-form #message-input-wrapper {
    flex: 1 1 auto !important;
}

/* When wrapper exists from the start, ensure proper styling */
#message-input-wrapper > #message-input {
    flex: 1 !important;
    width: 100% !important;
}

/* Fix the textarea to expand properly */
#user-input {
    flex: 1;
    width: 100%;
    min-width: 0; /* Allow flexbox to shrink below intrinsic width */
    box-sizing: border-box;
    padding: 0.75rem 2.5rem 0.75rem 1.5rem; /* Normal padding - microphone overlays */
    font-size: 1rem;
    line-height: 1.5;
    border: 1px solid var(--border-color);
    border-radius: 25px; /* Half-circle rounded edges */
    background-color: var(--bg-color);
    color: var(--text-color);
    resize: vertical;
    min-height: 44px; /* Touch target size */
    max-height: 200px;
    font-family: inherit;
}

/* Ensure buttons don't shrink */
#clear-chat-btn,
#send-btn,
#voice-input-btn {
    flex-shrink: 0;
    min-width: 44px;
    height: 44px;
    display: flex;
    align-items: center;
    justify-content: center;
}

/* Override any theme-specific constraints */
.theme-modern .input-with-actions,
.theme-sunset .input-with-actions,
.theme-ocean .input-with-actions,
.theme-forest .input-with-actions,
.theme-midnight .input-with-actions {
    width: 100% !important;
}

/* Ensure proper layout on mobile too */
@media (max-width: 768px) {
    #chat-input-container {
        padding: 0.75rem;
        padding-bottom: calc(0.75rem + env(safe-area-inset-bottom, 0));
    }
    
    .input-with-actions {
        gap: 0.25rem;
    }
    
    #user-input {
        font-size: 16px; /* Prevent zoom on iOS */
        border-radius: 22px; /* Slightly smaller radius on mobile */
        padding: 0.75rem 2.5rem 0.75rem 1.2rem; /* Adjusted padding for mobile with microphone space */
    }
}

/* Fix for desktop widths */
@media (min-width: 769px) {
    #chat-input-container {
        padding: 1rem;
    }
    
    .input-with-actions {
        max-width: none; /* Remove any max-width constraints */
    }
}

/* Debug - add visual border to see the actual size */
.debug-layout #chat-input-container {
    border: 2px solid red;
}

.debug-layout .input-with-actions {
    border: 2px solid blue;
}

.debug-layout #user-input {
    border: 2px solid green;
}